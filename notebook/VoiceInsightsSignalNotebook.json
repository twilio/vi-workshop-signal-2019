{"paragraphs":[{"text":"%md\n#                                                                             Define Data Model","user":"anonymous","dateUpdated":"2019-07-19T14:06:58-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563568487875_-1973946008","id":"20190719-133447_1832151649","dateCreated":"2019-07-19T13:34:47-0700","dateStarted":"2019-07-19T14:06:56-0700","dateFinished":"2019-07-19T14:06:56-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30453"},{"title":"Data Model For Converge API","text":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\n// Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)\n// So you don't need create them manually\n    @SerialVersionUID(100L)\n    case class CallSummaryAPI (\n                call_sid             : String,\n                parent_call_sid      : String,\n                account_sid          : String,\n                parent_account_sid   : String,\n                start_time           : String,\n                end_time             : String,\n                duration             : Int,\n                connect_duration     : Int,\n                call_type            : String,\n                call_state           : String,\n                call_direction       : String,\n                disconnect_by        : String,\n                from                 : Participant,\n                to                   : Participant,\n                processing_state     : String,\n                pdd_ms               : Int,\n                tags                 : Seq[String],\n                properties           : ViProperties\n            ) extends Serializable\n\n    @SerialVersionUID(100L)\n    case class Participant (\n               caller                : String,\n               callee                : String,\n               carrier               : String,\n               connection            : String,\n               number_prefix         : String,\n               location              : Location,\n               city                  : String,\n               country_code          : String,\n               country_subdivision   : String,\n               ip_address            : String\n           )\n\n    @SerialVersionUID(100L)\n    case class EdgeInfo (\n                properties            : ViProperties,\n                metrics               : MetricsContainer,\n                tags                  : Seq[String]\n            )\n\n    case class ViProperties (\n                last_sip_response_num  : Int,\n                pdd_ms                 : Int,\n                route_id               : String,\n                media_region           : String,\n                signaling_region       : String,\n                twilio_media_ip        : String,\n                twilio_signaling_ip    : String,\n                external_media_ip      : String,\n                external_signaling_ip  : String,\n                sip_call_id            : String,\n                user_agent             : String,\n                selected_region        : String,\n                region                 : String,\n                trunk_sid              : String\n            )\n\n    case class Location (\n                lat          : Float = 0.0f,\n                lon          : Float = 0.0f\n            )\n\n    case class MetricsContainer (\n                inbound               : Metric,\n                outbound              : Metric\n            )\n\n    case class Metric (\n                codec_name              : String,\n                packets_received        : Float,\n                packets_sent            : Float,\n                packets_lost            : Float,\n                packets_loss_percentage : Float,\n                jitter                  : Stats,\n                rtt                     : Stats,\n                mos                     : Stats,\n                audio_in                : Stats,\n                audio_out               : Stats,\n                latency                 : Stats,\n                codec                   : Int,\n                packet_delay_variation  : PacketDelayVariation\n            )\n\n    case class Stats (\n                min                     : Float,\n                max                     : Float,\n                avg                     : Float\n            )\n\n    case class PacketDelayVariation (\n                d50                     : Int,\n                d70                     : Int,\n                d90                     : Int,\n                d120                    : Int,\n                d150                    : Int,\n                d200                    : Int,\n                d300                    : Int\n             )\n","user":"anonymous","dateUpdated":"2019-07-19T11:13:25-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563303339907_1916339396","id":"20190716-115539_1416463356","dateCreated":"2019-07-16T11:55:39-0700","dateStarted":"2019-07-19T11:13:25-0700","dateFinished":"2019-07-19T11:13:36-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30454"},{"text":"%md\n# Define Encoder","user":"anonymous","dateUpdated":"2019-07-19T14:06:26-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563570342897_-345207446","id":"20190719-140542_403147261","dateCreated":"2019-07-19T14:05:42-0700","dateStarted":"2019-07-19T14:06:26-0700","dateFinished":"2019-07-19T14:06:26-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30455"},{"title":"Define Encoder","text":"// Define the Encoder\nval callSummary: Encoder[CallSummaryAPI] = Encoders.product[CallSummaryAPI]\nval schema = callSummary.schema\n\n\n","user":"anonymous","dateUpdated":"2019-07-19T11:13:40-0700","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563301544793_1008780574","id":"20190709-184841_1076288761","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T11:13:40-0700","dateFinished":"2019-07-19T11:13:42-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30456"},{"text":"%md\n# Load The Data","user":"anonymous","dateUpdated":"2019-07-19T14:06:21-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563570356933_192675617","id":"20190719-140556_1119448944","dateCreated":"2019-07-19T14:05:56-0700","dateStarted":"2019-07-19T14:06:21-0700","dateFinished":"2019-07-19T14:06:21-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30457"},{"title":"Load the data","text":"// load watcher data\nval df = spark.read.schema(schema).parquet(\"hdfs://voice-hadoop1-namenode1.stage.twilio.com:9000/voiceinsights/hive/api/v2/calls-compress/year=2019/month=7/part-00000-126e1d1a-9fc3-44f9-a906-e32718740740-c000.snappy.parquet\")","user":"anonymous","dateUpdated":"2019-07-19T11:13:46-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563326214892_148577912","id":"20190716-181654_62205425","dateCreated":"2019-07-16T18:16:54-0700","dateStarted":"2019-07-19T11:13:46-0700","dateFinished":"2019-07-19T11:13:48-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30458"},{"title":"Create Temp View","text":"val table = df.createOrReplaceTempView(\"calls_api_v2\")\n\n// describe calls api\nspark.sql(\"describe calls_api_v2\").show()\n\n","user":"anonymous","dateUpdated":"2019-07-19T11:13:51-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563302626463_-267547386","id":"20190716-114346_633216371","dateCreated":"2019-07-16T11:43:46-0700","dateStarted":"2019-07-19T11:13:51-0700","dateFinished":"2019-07-19T11:13:52-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30459"},{"title":"Count Number of rows using sql","text":"// Total Rows\nval totalRows = spark.sql(\"select count(call_sid) from calls_api_v2\")\ntotalRows.show(false)","user":"anonymous","dateUpdated":"2019-07-19T13:03:15-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=44"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563324769120_-1160801302","id":"20190716-175249_602889125","dateCreated":"2019-07-16T17:52:49-0700","dateStarted":"2019-07-19T13:03:15-0700","dateFinished":"2019-07-19T13:03:16-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30460"},{"title":"Select limited fields","text":"import org.apache.spark.sql.functions._ \nval rows = spark.sql(\"select x, account_sid, parent_account_sid, start_time, end_time, from.caller, from.carrier as caller_carrier, to.callee, to.carrier as callee_carrier, properties.last_sip_response_num as sip_response, tags, connect_duration, pdd_ms, call_state from calls_api_v2\")\n    .withColumn(\"end_time\", to_timestamp(col(\"end_time\")))\n    .withColumn(\"year\", year(col(\"end_time\")))\n    .withColumn(\"month\", month(col(\"end_time\")))\n    .withColumn(\"day\", dayofmonth(col(\"end_time\")))\n    .cache \nrows.createOrReplaceTempView(\"call_summaries\")\nrows.show()","user":"anonymous","dateUpdated":"2019-07-19T14:37:20-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=63","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=64","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=65"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301842684_-1012814367","id":"20190716-113042_2100423468","dateCreated":"2019-07-16T11:30:42-0700","dateStarted":"2019-07-19T13:16:33-0700","dateFinished":"2019-07-19T13:17:31-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30461"},{"title":"Calls With Tag Silence","text":"%sql\nselect count(call_sid) as calls, account_sid, day\nfrom call_summaries \nwhere array_contains(tags, \"tag_silent\") \nAND account_sid = \"ACeb55c9fb3d2e16d378a0a6d2ffd53608\"\ngroup by account_sid, day \norder by calls desc\nlimit 15","user":"anonymous","dateUpdated":"2019-07-19T15:32:49-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":345.641,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"calls":"string","account_sid":"string","day":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","forceY":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"calls","index":0,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86.1667,"optionOpen":false}}},"enabled":true,"runOnSelectionChange":true},"settings":{"params":{"tag":"tag_high_pdd"},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=66"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301544793_-645407652","id":"20190709-190914_1823262601","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:17:36-0700","dateFinished":"2019-07-19T13:17:36-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30462"},{"title":"Callee Carrier Over Sip Response ( except 200 OK )","text":"%sql\nselect count(callee_carrier) as calls, sip_response \nfrom call_summaries \nwhere sip_response != 200 AND sip_response != 0\ngroup by sip_response\norder by calls","user":"anonymous","dateUpdated":"2019-07-19T13:17:40-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":262,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"calls":"string","sip_response":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"scatterChart":{"xAxis":{"name":"calls","index":0,"aggr":"sum"},"yAxis":{"name":"sip_response","index":1,"aggr":"sum"},"size":{"name":"calls","index":0,"aggr":"sum"}},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"keys":[],"groups":[],"values":[{"name":"calls","index":0,"aggr":"sum"}],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=67"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301544796_-183517336","id":"20190709-192318_2038372897","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:17:40-0700","dateFinished":"2019-07-19T13:17:40-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30463"},{"title":"Noanswer Calls","text":"%sql\nselect count(call_sid) calls, account_sid \nfrom call_summaries \nwhere call_state == \"noanswer\"  \ngroup by account_sid \norder by calls","user":"anonymous","dateUpdated":"2019-07-19T13:17:44-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":358.297,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"calls":"string","account_sid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"account_sid","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"calls","index":0,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=68"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301544796_-1171217566","id":"20190709-192338_1497494942","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:17:44-0700","dateFinished":"2019-07-19T13:17:45-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30464"},{"title":"Busy Calls","text":"%sql\nselect count(call_sid) calls, account_sid \nfrom call_summaries \nwhere call_state == \"busy\"  \ngroup by account_sid \norder by calls","user":"anonymous","dateUpdated":"2019-07-19T13:17:49-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":363.766,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"calls":"string","account_sid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"account_sid","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"calls","index":0,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=69"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301544797_-208723213","id":"20190709-192355_1109337791","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:17:49-0700","dateFinished":"2019-07-19T13:17:49-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30465"},{"title":"Failed Calls","text":"%sql\nselect count(call_sid) calls, account_sid \nfrom call_summaries \nwhere call_state == \"fail\"  \ngroup by account_sid \norder by calls","user":"anonymous","dateUpdated":"2019-07-19T13:17:52-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"scatterChart","height":357.891,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"calls":"string","account_sid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"account_sid","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"calls","index":0,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=70"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563301544798_-1709624160","id":"20190709-192411_474204600","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:17:52-0700","dateFinished":"2019-07-19T13:17:52-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30466"},{"text":"%sql\nselect account_sid, count(call_sid) as calls from call_summaries group by account_sid order by calls desc\n","user":"anonymous","dateUpdated":"2019-07-19T15:32:49-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"account_sid":"string","calls":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"account_sid","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"calls","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=71"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563567133983_1267585646","id":"20190719-131213_1874274235","dateCreated":"2019-07-19T13:12:13-0700","dateStarted":"2019-07-19T13:18:00-0700","dateFinished":"2019-07-19T13:18:00-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30467"},{"text":"%spark\n rows.groupBy($\"account_sid\")\n     .agg(\n        count(\"call_sid\") as (\"calls\"),\n        avg(\"connect_duration\") as (\"avg_connect_duration\"),\n        avg(\"pdd_ms\") as (\"avg_pdd_ms\")\n        )\n        .orderBy(desc(\"calls\"))\n        .createOrReplaceTempView(\"call_summary_aggregate\")\n","user":"anonymous","dateUpdated":"2019-07-19T13:45:01-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563568704681_-1690848177","id":"20190719-133824_352494273","dateCreated":"2019-07-19T13:38:24-0700","dateStarted":"2019-07-19T13:45:01-0700","dateFinished":"2019-07-19T13:45:01-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30468"},{"title":"Account Aggregate over Connect Duration/Post Dial Delay","text":"%sql\nselect * from call_summary_aggregate limit 8","user":"anonymous","dateUpdated":"2019-07-19T15:32:49-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"account_sid":"string","calls":"string","avg_connect_duration":"string","avg_pdd_ms":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"account_sid","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_connect_duration","index":2,"aggr":"sum"},{"name":"avg_pdd_ms","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=92"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563569105106_828446899","id":"20190719-134505_1531533991","dateCreated":"2019-07-19T13:45:05-0700","dateStarted":"2019-07-19T13:47:21-0700","dateFinished":"2019-07-19T13:47:22-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30469"},{"title":"Apply GroupBy with Window function","text":"%spark\nval windowed = rows.groupBy($\"account_sid\", window(col(\"end_time\"), \"1 hour\"))\n\nval agg = windowed.agg(count(\"call_sid\") as (\"calls\"), avg(connect_duration) as avg_connect_duration)\n   \nagg.show(false)\n\nagg.createOrReplaceTempView(\"per_hour_report\")","user":"anonymous","dateUpdated":"2019-07-19T13:30:45-0700","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":90,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563301544801_-571225235","id":"20190711-111721_570304098","dateCreated":"2019-07-16T11:25:44-0700","dateStarted":"2019-07-19T13:30:42-0700","dateFinished":"2019-07-19T13:30:42-0700","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30470"},{"text":"%spark\nspark.sql(\"select * from per_hour_report where account_sid= \\\"ACac502024cc06ea00cdab69cfb27498d0\\\"\").show(false)","user":"anonymous","dateUpdated":"2019-07-19T12:03:38-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=31","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=32","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=33"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563327834021_-875918229","id":"20190716-184354_2079140764","dateCreated":"2019-07-16T18:43:54-0700","dateStarted":"2019-07-19T12:03:38-0700","dateFinished":"2019-07-19T12:03:39-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30471"},{"text":"%sql\nselect * from per_hour_report where account_sid= \"ACac502024cc06ea00cdab69cfb27498d0\"","user":"anonymous","dateUpdated":"2019-07-19T13:02:41-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"account_sid":"string","window":"string","calls":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=34","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=35","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=36","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=37","http://ec2-34-229-97-245.compute-1.amazonaws.com:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1563327845664_-278289433","id":"20190716-184405_1916672086","dateCreated":"2019-07-16T18:44:05-0700","dateStarted":"2019-07-19T12:03:45-0700","dateFinished":"2019-07-19T12:03:45-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30472"}],"name":"Voice Insights Call Summary API","id":"2EGY59V81","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}